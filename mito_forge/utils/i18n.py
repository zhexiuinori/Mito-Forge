# Centralized i18n utilities for Mito-Forge
# Provide translation helpers used across CLI commands.
# Usage:
#   from ...utils.i18n import t, tl
#   t(key) -> auto-detect language from MITO_LANG
#   t(key, lang='en') -> explicit language
#   tl(lang, key) -> signature compatible wrapper for existing code: _t(lang, key)

import os

# Translation dictionaries
_TEXTS = {
    "zh": {
        # Common
        "error": "é”™è¯¯",
        # Model command
        "no_profiles": "æ²¡æœ‰æ‰¾åˆ°æ¨¡åž‹é…ç½®",
        "available_profiles": "å¯ç”¨çš„æ¨¡åž‹é…ç½®:",
        "name": "åç§°",
        "description": "æè¿°",
        "provider": "æä¾›è€…",
        "model": "æ¨¡åž‹",
        "status": "çŠ¶æ€",
        "available": "âœ… å¯ç”¨",
        "unavailable": "âŒ ä¸å¯ç”¨",
        "profile_not_exists": "é…ç½®ä¸å­˜åœ¨",
        "config_label": "é…ç½®",
        "testing_config": "æµ‹è¯•é…ç½®",
        "testing": "æµ‹è¯•ä¸­...",
        "test_success": "âœ… æµ‹è¯•æˆåŠŸ!",
        "test_failed": "âŒ æµ‹è¯•å¤±è´¥!",
        "set_default_ok": "âœ… å·²è®¾ç½®é»˜è®¤é…ç½®ä¸º",
        "add_ok": "âœ… å·²æ·»åŠ é…ç½®",
        "add_fail": "âŒ æ·»åŠ é…ç½®å¤±è´¥",
        "confirm_test_new": "æ˜¯å¦æµ‹è¯•æ–°é…ç½®?",
        "update_no_fields": "æ²¡æœ‰æŒ‡å®šè¦æ›´æ–°çš„å­—æ®µ",
        "update_ok": "âœ… å·²æ›´æ–°é…ç½®",
        "update_test_success": "âœ… é…ç½®æµ‹è¯•æˆåŠŸ!",
        "update_test_failed": "âŒ é…ç½®æµ‹è¯•å¤±è´¥",
        "remove_ok": "âœ… å·²åˆ é™¤é…ç½®",
        "presets_available": "å¯ç”¨çš„é¢„è®¾é…ç½®:",
        "api_base": "API åŸºç¡€",
        "default_model": "é»˜è®¤æ¨¡åž‹",
        "api_format": "API æ ¼å¼",
        # Config command
        "reset_ok": "âœ… [bold green]é…ç½®å·²é‡ç½®ä¸ºé»˜è®¤å€¼[/bold green]",
        "set_ok": "âœ… è®¾ç½®",
        "saved_to": "ðŸ’¾ é…ç½®å·²ä¿å­˜åˆ°",
        "cfg_title": "Mito-Forge é…ç½®",
        "list_label": "é…ç½®é¡¹åˆ—è¡¨:",
        "desc_label": "è¯´æ˜Ž",
        "not_set": "æœªè®¾ç½®",
        "file_label": "é…ç½®æ–‡ä»¶",
        "hint_set": "ðŸ’¡ ä½¿ç”¨ 'mito-forge config --set KEY VALUE' ä¿®æ”¹é…ç½®",
        "desc_threads": "çº¿ç¨‹æ•°",
        "desc_memory": "å†…å­˜é™åˆ¶",
        "desc_quality_threshold": "è´¨é‡é˜ˆå€¼",
        "desc_assembler": "é»˜è®¤ç»„è£…å™¨",
        "desc_annotation_tool": "é»˜è®¤æ³¨é‡Šå·¥å…·",
        "desc_output_dir": "é»˜è®¤è¾“å‡ºç›®å½•",
        "desc_log_level": "æ—¥å¿—çº§åˆ«",
        "desc_temp_dir": "ä¸´æ—¶ç›®å½•",
        # Pipeline command
        "header": "ðŸ§¬ Mito-Forge æµæ°´çº¿ï¼ˆLangGraph ç‰ˆï¼‰",
        "input_file": "è¾“å…¥æ–‡ä»¶",
        "input_file2": "è¾“å…¥æ–‡ä»¶ (R2)",
        "auto_detect_r2": "è‡ªåŠ¨æ£€æµ‹åˆ°åŒç«¯æ•°æ® R2",
        "output_dir": "è¾“å‡ºç›®å½•",
        "kingdom": "ç‰©ç§ç±»åž‹",
        "start": "å¼€å§‹æ‰§è¡Œæµæ°´çº¿...",
        "done": "æµæ°´çº¿æ‰§è¡Œå®Œæˆ",
        "resume_from": "ä»Žæ£€æŸ¥ç‚¹æ¢å¤",
        "summary_title": "ðŸ“Š æµæ°´çº¿æ‰§è¡Œæ‘˜è¦",
        "pipeline_id": "æµæ°´çº¿ID",
        "status_title": "æ‰§è¡ŒçŠ¶æ€",
        "status_done": "âœ… å®Œæˆ",
        "status_running": "ðŸ”„ è¿›è¡Œä¸­",
        "current_stage": "å½“å‰é˜¶æ®µ",
        "completed_stages": "å·²å®Œæˆé˜¶æ®µ",
        "duration": "æ‰§è¡Œæ—¶é—´",
        "seconds": "ç§’",
        "stage_results": "ðŸ“‹ å„é˜¶æ®µç»“æžœ",
        "metrics": "å…³é”®æŒ‡æ ‡",
        "files": "è¾“å‡ºæ–‡ä»¶",
        "more_metrics": "ä¸ªæŒ‡æ ‡",
        "more_files": "ä¸ªæ–‡ä»¶",
        "errors": "é”™è¯¯",
        "warnings": "è­¦å‘Š",
        "main_outputs": "ä¸»è¦è¾“å‡ºæ–‡ä»¶",
        "qc_report": "QC æŠ¥å‘Š",
        "mito_seq": "çº¿ç²’ä½“åºåˆ—",
        "assembly_stats": "ç»„è£…ç»Ÿè®¡",
        "gff": "åŸºå› æ³¨é‡Š (GFF)",
        "table": "æ³¨é‡Šè¡¨æ ¼",
        "final_report": "ðŸ“Š æœ€ç»ˆæŠ¥å‘Š",
        # Config help
        "cfg_help_title": "é…ç½®ç®¡ç†",
        "cfg_help_desc": "ç®¡ç† Mito-Forge çš„é…ç½®å‚æ•°",
        "cfg_opt_show": "æ˜¾ç¤ºå½“å‰é…ç½®",
        "cfg_opt_set": "è®¾ç½®é…ç½®é¡¹",
        "cfg_opt_reset": "é‡ç½®ä¸ºé»˜è®¤é…ç½®",
        "cfg_opt_config_file": "æŒ‡å®šé…ç½®æ–‡ä»¶è·¯å¾„",
        # Pipeline help options
        "pl_opt_reads": "è¾“å…¥æµ‹åºæ•°æ®æ–‡ä»¶ï¼ˆR1 æˆ–å•ç«¯ï¼‰",
        "pl_opt_reads2": "ç¬¬äºŒä¸ªæµ‹åºæ–‡ä»¶ï¼ˆåŒç«¯æµ‹åº R2ï¼Œå¯é€‰ï¼‰",
        "pl_opt_output": "è¾“å‡ºç›®å½•",
        "pl_opt_threads": "çº¿ç¨‹æ•°",
        "pl_opt_kingdom": "ç‰©ç§ç±»åž‹",
        "pl_opt_resume": "ä»Žæ£€æŸ¥ç‚¹æ¢å¤æ‰§è¡Œ",
        "pl_opt_checkpoint": "æ£€æŸ¥ç‚¹ä¿å­˜è·¯å¾„",
        "pl_opt_config_file": "é…ç½®æ–‡ä»¶è·¯å¾„",
        "pl_opt_verbose": "è¯¦ç»†è¾“å‡º",
        "pl_opt_interactive": "äº¤äº’å¼é”™è¯¯å¤„ç†",
        "pl_opt_lang": "è¾“å‡ºè¯­è¨€",
        # QC help
        "qc.help.desc": "æ‰§è¡Œè´¨é‡æŽ§åˆ¶åˆ†æž",
        "qc.opt.output_dir": "è¾“å‡ºç›®å½• (é»˜è®¤: ./qc_results)",
        "qc.opt.quality_threshold": "è´¨é‡é˜ˆå€¼ (é»˜è®¤: 20)",
        "qc.opt.threads": "çº¿ç¨‹æ•° (é»˜è®¤: 4)",
        "qc.opt.adapter_removal": "æ‰§è¡ŒæŽ¥å¤´åºåˆ—åŽ»é™¤",
        "qc.opt.trim_quality": "ä¿®å‰ªè´¨é‡é˜ˆå€¼ (é»˜è®¤: 20)",
        "qc.opt.min_length": "æœ€å°åºåˆ—é•¿åº¦ (é»˜è®¤: 50)",
        "qc.opt.report_only": "ä»…ç”Ÿæˆè´¨æŽ§æŠ¥å‘Šï¼Œä¸è¿›è¡Œæ•°æ®å¤„ç†",
        # Assembly help
        "asm.help.desc": "æ‰§è¡ŒåŸºå› ç»„ç»„è£…åˆ†æž",
        "asm.opt.output_dir": "è¾“å‡ºç›®å½• (é»˜è®¤: ./assembly_results)",
        "asm.opt.assembler": "ç»„è£…å™¨é€‰æ‹© (é»˜è®¤: spades)",
        "asm.opt.threads": "çº¿ç¨‹æ•° (é»˜è®¤: 4)",
        "asm.opt.memory": "å†…å­˜é™åˆ¶ (é»˜è®¤: 8G)",
        "asm.opt.k_values": "K-merå€¼ (é»˜è®¤: 21,33,55,77)",
        "asm.opt.careful_mode": "å¯ç”¨carefulæ¨¡å¼ï¼ˆæ›´æ…¢ä½†æ›´å‡†ç¡®ï¼‰",
        # Annotate help
        "ann.help.desc": "æ‰§è¡ŒåŸºå› æ³¨é‡Šåˆ†æž",
        "ann.opt.output_dir": "è¾“å‡ºç›®å½• (é»˜è®¤: ./annotation_results)",
        "ann.opt.annotation_tool": "æ³¨é‡Šå·¥å…·é€‰æ‹© (é»˜è®¤: mitos)",
        "ann.opt.threads": "çº¿ç¨‹æ•° (é»˜è®¤: 4)",
        "ann.opt.genetic_code": "é—ä¼ å¯†ç è¡¨ (é»˜è®¤: 2 - è„Šæ¤ŽåŠ¨ç‰©çº¿ç²’ä½“)",
        "ann.opt.reference_db": "å‚è€ƒæ•°æ®åº“ (é»˜è®¤: mitochondria)",
    },
    "en": {
        # Common
        "error": "Error",
        # Model command
        "no_profiles": "No model profiles found",
        "available_profiles": "Available model profiles:",
        "name": "Name",
        "description": "Description",
        "provider": "Provider",
        "model": "Model",
        "status": "Status",
        "available": "âœ… Available",
        "unavailable": "âŒ Unavailable",
        "profile_not_exists": "Profile does not exist",
        "config_label": "Profile",
        "testing_config": "Testing profile",
        "testing": "Testing...",
        "test_success": "âœ… Test succeeded!",
        "test_failed": "âŒ Test failed!",
        "set_default_ok": "âœ… Set default profile to",
        "add_ok": "âœ… Added profile",
        "add_fail": "âŒ Failed to add profile",
        "confirm_test_new": "Test the new profile?",
        "update_no_fields": "No fields specified to update",
        "update_ok": "âœ… Updated profile",
        "update_test_success": "âœ… Profile test succeeded!",
        "update_test_failed": "âŒ Profile test failed",
        "remove_ok": "âœ… Removed profile",
        "presets_available": "Available preset profiles:",
        "api_base": "API base",
        "default_model": "Default model",
        "api_format": "API format",
        # Config command
        "reset_ok": "âœ… [bold green]Reset to defaults[/bold green]",
        "set_ok": "âœ… Set",
        "saved_to": "ðŸ’¾ Config saved to",
        "cfg_title": "Mito-Forge Config",
        "list_label": "Configuration items:",
        "desc_label": "Description",
        "not_set": "Not set",
        "file_label": "Config file",
        "hint_set": "ðŸ’¡ Use 'mito-forge config --set KEY VALUE' to modify",
        "desc_threads": "Threads",
        "desc_memory": "Memory limit",
        "desc_quality_threshold": "Quality threshold",
        "desc_assembler": "Default assembler",
        "desc_annotation_tool": "Default annotation tool",
        "desc_output_dir": "Default output directory",
        "desc_log_level": "Log level",
        "desc_temp_dir": "Temporary directory",
        # Pipeline command
        "header": "ðŸ§¬ Mito-Forge Pipeline (LangGraph Edition)",
        "input_file": "Input file",
        "output_dir": "Output directory",
        "kingdom": "Kingdom",
        "start": "Starting pipeline...",
        "done": "Pipeline finished",
        "resume_from": "Resume from checkpoint",
        "summary_title": "ðŸ“Š Pipeline Summary",
        "pipeline_id": "Pipeline ID",
        "status_title": "Status",
        "status_done": "âœ… Done",
        "status_running": "ðŸ”„ Running",
        "current_stage": "Current stage",
        "completed_stages": "Completed stages",
        "duration": "Duration",
        "seconds": "s",
        "stage_results": "ðŸ“‹ Stage results",
        "metrics": "Key metrics",
        "files": "Output files",
        "more_metrics": "more metrics",
        "more_files": "more files",
        "errors": "Errors",
        "warnings": "Warnings",
        "main_outputs": "Main output files",
        "qc_report": "QC report",
        "mito_seq": "Mitochondrial sequences",
        "assembly_stats": "Assembly stats",
        "gff": "Gene annotation (GFF)",
        "table": "Annotation table",
        "final_report": "ðŸ“Š Final report",
        # Config help
        "cfg_help_title": "Configuration management",
        "cfg_help_desc": "Manage Mito-Forge configuration parameters",
        "cfg_opt_show": "Show current configuration",
        "cfg_opt_set": "Set configuration item",
        "cfg_opt_reset": "Reset to default configuration",
        "cfg_opt_config_file": "Specify config file path",
        # Pipeline help options
        "pl_opt_reads": "Input sequencing data file (R1 or single-end)",
        "pl_opt_reads2": "Second sequencing file (paired-end R2, optional)",
        "pl_opt_output": "Output directory",
        "pl_opt_threads": "Number of threads",
        "pl_opt_kingdom": "Kingdom",
        "pl_opt_resume": "Resume from checkpoint",
        "pl_opt_checkpoint": "Checkpoint file path",
        "pl_opt_config_file": "Config file path",
        "pl_opt_verbose": "Verbose output",
        "pl_opt_interactive": "Interactive error handling",
        "pl_opt_lang": "Output language",
        # QC help
        "qc.help.desc": "Run quality control analysis",
        "qc.opt.output_dir": "Output directory (default: ./qc_results)",
        "qc.opt.quality_threshold": "Quality threshold (default: 20)",
        "qc.opt.threads": "Threads (default: 4)",
        "qc.opt.adapter_removal": "Perform adapter removal",
        "qc.opt.trim_quality": "Trim quality threshold (default: 20)",
        "qc.opt.min_length": "Minimum read length (default: 50)",
        "qc.opt.report_only": "Generate QC report only, no processing",
        # Assembly help
        "asm.help.desc": "Run genome assembly analysis",
        "asm.opt.output_dir": "Output directory (default: ./assembly_results)",
        "asm.opt.assembler": "Assembler choice (default: spades)",
        "asm.opt.threads": "Threads (default: 4)",
        "asm.opt.memory": "Memory limit (default: 8G)",
        "asm.opt.k_values": "K-mer values (default: 21,33,55,77)",
        "asm.opt.careful_mode": "Enable careful mode (slower but more accurate)",
        # Annotate help
        "ann.help.desc": "Run gene annotation analysis",
        "ann.opt.output_dir": "Output directory (default: ./annotation_results)",
        "ann.opt.annotation_tool": "Annotation tool choice (default: mitos)",
        "ann.opt.threads": "Threads (default: 4)",
        "ann.opt.genetic_code": "Genetic code (default: 2 - Vertebrate mitochondrial)",
        "ann.opt.reference_db": "Reference database (default: mitochondria)",
    },
}

def t(key: str, lang: str | None = None) -> str:
    """Translate a key using specified lang or env MITO_LANG (default zh)."""
    if lang is None:
        lang = os.getenv("MITO_LANG", "zh")
    return _TEXTS.get(lang, _TEXTS["zh"]).get(key, key)

def tl(lang: str, key: str) -> str:
    """Translate with signature tl(lang, key) for backward compatibility."""
    return t(key, lang)